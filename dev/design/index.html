<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Design and Internals · GeometricAlgebra.jl</title><meta name="title" content="Design and Internals · GeometricAlgebra.jl"/><meta property="og:title" content="Design and Internals · GeometricAlgebra.jl"/><meta property="twitter:title" content="Design and Internals · GeometricAlgebra.jl"/><meta name="description" content="Documentation for GeometricAlgebra.jl."/><meta property="og:description" content="Documentation for GeometricAlgebra.jl."/><meta property="twitter:description" content="Documentation for GeometricAlgebra.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="GeometricAlgebra.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="GeometricAlgebra.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeometricAlgebra.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">User Guide</a></li><li class="is-active"><a class="tocitem" href>Design and Internals</a><ul class="internal"><li><a class="tocitem" href="#Multivector-Types"><span>Multivector Types</span></a></li><li><a class="tocitem" href="#sig"><span>Metric Signatures</span></a></li><li><a class="tocitem" href="#Symbolic-Algebra-and-Code-Generation"><span>Symbolic Algebra and Code Generation</span></a></li></ul></li><li><span class="tocitem">Mathematical Background</span><ul><li><a class="tocitem" href="../theory/basics/">Introduction</a></li><li><a class="tocitem" href="../theory/products/">Wedge, Inner and Other Products</a></li><li><a class="tocitem" href="../theory/automorphisms/">Fundamental Automorphisms</a></li><li><a class="tocitem" href="../theory/dualities/">Dualities</a></li><li><a class="tocitem" href="../theory/rotors/">Rotors</a></li><li><a class="tocitem" href="../theory/special/">Inverses, Roots and Logarithms</a></li><li><a class="tocitem" href="../theory/references/">References</a></li></ul></li><li><a class="tocitem" href="../docstrings/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Design and Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Design and Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jollywatt/GeometricAlgebra.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jollywatt/GeometricAlgebra.jl/blob/master/docs/src/design.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Design-and-Internals"><a class="docs-heading-anchor" href="#Design-and-Internals">Design and Internals</a><a id="Design-and-Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Design-and-Internals" title="Permalink"></a></h1><h2 id="Multivector-Types"><a class="docs-heading-anchor" href="#Multivector-Types">Multivector Types</a><a id="Multivector-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Multivector-Types" title="Permalink"></a></h2><p>There are two concrete types for representing elements in a geometric algebra:</p><pre><code class="nohighlight hljs">         AbstractMultivector{Sig}
            /               \                             
BasisBlade{Sig,K,T}    Multivector{Sig,K,S}</code></pre><ul><li><a href="../docstrings/#GeometricAlgebra.BasisBlade"><code>BasisBlade</code></a>: a scalar multiple of a wedge product of orthogonal basis vectors.</li><li><a href="../docstrings/#GeometricAlgebra.Multivector"><code>Multivector</code></a>: a homogeneous or inhomogeneous multivector; a sum of basis blades.</li></ul><p>Type parameters:</p><ul><li><code>Sig</code>: The metric signature which defines the geometric algebra. This can be any  all-bits value which satisfies the <a href="#sig-interface">metric signature interface</a>.</li><li><code>K</code>: The grade(s) of a multivector. For <code>BasisBlade</code>s, this is an integer, but for <code>Multivector</code>s, it may be a collection (e.g., <code>0:3</code> for a general 3D multivector).</li><li><code>T</code>: The numerical type of the coefficient of a <code>BasisBlade</code>.</li><li><code>S</code>: The storage type of the components of a <code>Multivector</code>, usually an <code>AbstractVector</code> subtype.</li></ul><h2 id="sig"><a class="docs-heading-anchor" href="#sig">Metric Signatures</a><a id="sig-1"></a><a class="docs-heading-anchor-permalink" href="#sig" title="Permalink"></a></h2><p>The metric signature type parameter <code>Sig</code> defines the dimension of the geometric algebra and the norms of its standard orthonormal basis vectors. Additionally, it allows various default behaviours to be customised through method definitions which dispatch on <code>Sig</code>, as detailed in <a href="#sig-interface">the metric signature interface</a>.</p><p>By default, the following metric signature types are implemented:</p><ul><li><code>Int</code>, defining a Euclidean metric of that dimension,</li><li><code>Tuple</code>, defining the norms of each basis vector,</li><li><code>NamedTuple</code>, defining basis vector labels as well as norms,</li><li><a href="../docstrings/#GeometricAlgebra.Cl"><code>Cl</code></a>, a type resembling the notation <span>$Cl(p, q, r)$</span> common in literature.</li></ul><pre><code class="language-julia-repl hljs">julia&gt; @basis 2
[ Info: Defined basis blades v1, v2, v12, I in Main

julia&gt; basis((t=-1, x=1, y=1, z=1)) |&gt; prod
BasisBlade{(t = -1, x = 1, y = 1, z = 1), 4, Int64}:
 1 txyz

julia&gt; sum(basis(Cl(&quot;++&quot;))) # shorthand for metric signature (1, 1)
2-component Multivector{Cl(&quot;++&quot;), 1, SVector{2, Int64}}:
 1 v1
 1 v2</code></pre><h3 id="sig-interface"><a class="docs-heading-anchor" href="#sig-interface">The metric signature interface</a><a id="sig-interface-1"></a><a class="docs-heading-anchor-permalink" href="#sig-interface" title="Permalink"></a></h3><p>The metric signature type parameter may be any <code>isbits</code> value satisying the following interface. As well as defining the geometric algebra, the signature is used to specify basis blade labels, the default array type for multivector components, and other metadata.</p><table><tr><th style="text-align: left">Required methods</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>dimension(sig)</code></td><td style="text-align: left">The dimension of the underlying vector space, or number of basis vectors.</td></tr><tr><td style="text-align: left"><code>basis_vector_square(sig, i)</code></td><td style="text-align: left">The scalar square of the <code>i</code>th basis vector.</td></tr></table><table><tr><th style="text-align: left">Optional methods</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>show_signature(io, sig)</code></td><td style="text-align: left">Show the metric signature in a compact human-readable form.</td></tr><tr><td style="text-align: left"><code>show_basis_blade(io, sig, indices)</code></td><td style="text-align: left">Print a basis blade with the given indices (e.g., <code>v12</code> or <code>𝒆₁∧𝒆₂</code>).</td></tr><tr><td style="text-align: left"><code>bits_to_indices(sig, bits)</code></td><td style="text-align: left">Define display order of indices for a basis blade (must also implement <code>basis_blade_parity(sig, bits)</code> consistently).</td></tr><tr><td style="text-align: left"><code>componentstype(sig, N)</code></td><td style="text-align: left">Preferred array type for <code>Multivector{sig}</code> components. (E.g., <code>Vector</code>, <code>MVector</code>, <code>SparseVector</code>, etc.)</td></tr><tr><td style="text-align: left"><code>use_symbolic_optim(sig)</code></td><td style="text-align: left">Whether to use symbolic code generation to optimise multivector products. (Default is true for low dimensions.)</td></tr></table><p>Below is an example of how one might define a “projectivised” signature which adds a projective dimension <span>$𝐯_0$</span> squaring to <span>$-1$</span> to any signature:</p><pre><code class="language-julia hljs">import GeometricAlgebra: dimension, basis_vector_square, show_signature, show_basis_blade

struct ℙ{Sig} end
ℙ(sig) = ℙ{sig}()

dimension(::ℙ{Sig}) where Sig = dimension(Sig) + 1
basis_vector_square(::ℙ{Sig}, i) where Sig = i == 1 ? -1 : basis_vector_square(Sig, i - 1)
show_signature(io::IO, ::ℙ{Sig}) where Sig = print(io, &quot;ℙ($Sig)&quot;)

show_basis_blade(io::IO, ::ℙ, indices::Vector) = print(io, &quot;v&quot;, join(indices .- 1))

basis(ℙ(3)) |&gt; sum</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-component Multivector{ℙ(3), 1, SVector{4, Int64}}:
 1 v0
 1 v1
 1 v2
 1 v3</code></pre><h2 id="Symbolic-Algebra-and-Code-Generation"><a class="docs-heading-anchor" href="#Symbolic-Algebra-and-Code-Generation">Symbolic Algebra and Code Generation</a><a id="Symbolic-Algebra-and-Code-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Symbolic-Algebra-and-Code-Generation" title="Permalink"></a></h2><p>Thanks to the wonderful <a href="https://symbolicutils.juliasymbolics.org/"><code>SymbolicUtils</code></a> package, the same code originally written for numerical multivectors readily works with symbolic components. For example, we can compute the product of two vectors symbolically as follows:</p><pre><code class="language-julia-repl hljs">julia&gt; GeometricAlgebra.make_symbolic.(Multivector{2,1}, [:A, :B])
2-element Vector{Multivector{2, 1, Vector{GeometricAlgebra.MiniCAS.ProductNode{GeometricAlgebra.MiniCAS.IndexNode{1}}}}}:
 A[1]v1 + A[2]v2
 B[1]v1 + B[2]v2

julia&gt; prod(ans)
2-component Multivector{2, 0:2:2, SVector{2, GeometricAlgebra.MiniCAS.SumNode{GeometricAlgebra.MiniCAS.IndexNode{1}, Int64}}}:
 A[1] * B[1] + A[2] * B[2]
 -(A[2] * B[1]) + A[1] * B[2] v12</code></pre><p>This makes it easy to optimize multivector operations: first perform the calculation symbolically and then compile the resulting analytic expression. By default, this optimization is enabled for most products (including the geometric, wedge and inner products in up to eight dimensions<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>). This is done by prefixing method definitions with the internal <a href="../docstrings/#GeometricAlgebra.@symbolic_optim-Tuple{Expr}"><code>@symbolic_optim</code></a> macro.</p><p>Symbolic optimisation is also exposed through a user-facing macro <a href="../docstrings/#GeometricAlgebra.@symbolicga"><code>@symbolicga</code></a>, inspired by the <code>@ga</code> macro in <a href="https://github.com/serenity4/SymbolicGA.jl">serenity4/SymbolicGA.jl</a>. This is especially useful when you want use geometric algebra without manipulating <code>Multivector</code> types.</p><p>For example, using <span>$Cl(ℝ³)$</span> to represent homogeneous coordinates on the plane:</p><pre><code class="language-julia-repl hljs">julia&gt; joinpoints(p, q) = @symbolicga 3 (p=1, q=1) p ∧ q Tuple
joinpoints (generic function with 1 method)

julia&gt; intersectlines(p, q) = @symbolicga 3 (p=2, q=2) rdual(ldual(p) ∧ ldual(q)) Tuple
intersectlines (generic function with 1 method)

julia&gt; L1 = joinpoints((1, 0, 1), (0, 1, 1)) # line y = 1 - x
(1, 1, -1)

julia&gt; L2 = joinpoints((0, 0, 1), (1, 1, 1)) # line y = x
(0, -1, -1)

julia&gt; intersectlines(L1, L2) # point (0.5, 0.5)
(-1, -1, -2)
</code></pre><p>The resulting methods are loop-free and allocation-free.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>This can be changed on a per-algebra basis by defining methods for <a href="../docstrings/#GeometricAlgebra.use_symbolic_optim-Tuple{Any}"><code>use_symbolic_optim()</code></a>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« User Guide</a><a class="docs-footer-nextpage" href="../theory/basics/">Introduction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 11 March 2025 17:48">Tuesday 11 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
